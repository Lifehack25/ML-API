name = "ml-api"
main = "src/index.ts"
compatibility_date = "2024-10-01"
workers_dev = true

[observability]
enabled = false
head_sampling_rate = 1

[observability.logs]
enabled = true
head_sampling_rate = 1
persist = true
invocation_logs = true

[observability.traces]
enabled = true
persist = true
head_sampling_rate = 1

[vars]
APPLE_BUNDLE_ID = "com.memorylocks.mlmobileapp"

[[d1_databases]]
binding = "DB"
database_id = "3afe1cf6-4d2c-4461-9b41-1c8e232e8361"

[[kv_namespaces]]
binding = "IDEMPOTENCY_KEYS"
id = "68c9b0be5f2743eba3b7394948b162e2"

[[kv_namespaces]]
binding = "RATE_LIMIT"
id = "e87dedccbff34b63aa40ba398f2c456d"

# Cron triggers for background jobs
[triggers]
crons = [
  "*/15 * * * *"    # Every 15 minutes: process Cloudflare cleanup jobs
]
